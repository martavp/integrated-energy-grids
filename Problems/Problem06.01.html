
<!DOCTYPE html>


<html lang="en" data-content_root="../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Problem 6.1 &#8212; integrated-energy-grids</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/sphinx-book-theme.css?v=eba8b062" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../_static/doctools.js?v=9a2dae69"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../_static/copybutton.js?v=f281be69"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'Problems/Problem06.01';</script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Problem 6.2" href="Problem06.02.html" />
    <link rel="prev" title="Problem 5.4" href="Problem05.04.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../_static/DTUlogo.jpg" class="logo__image only-light" alt="integrated-energy-grids - Home"/>
    <script>document.write(`<img src="../_static/DTUlogo.jpg" class="logo__image only-dark" alt="integrated-energy-grids - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../intro.html">
                    Welcome
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../intro-install.html">Python and Conda</a></li>







<li class="toctree-l1"><a class="reference internal" href="../intro-gurobi.html">Gurobi</a></li>
<li class="toctree-l1"><a class="reference internal" href="../intro-python.html">Introduction to <code class="docutils literal notranslate"><span class="pre">Python</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="../intro-numpy.html">Introduction to <code class="docutils literal notranslate"><span class="pre">numpy</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="../intro-matplotlib.html">Introduction to <code class="docutils literal notranslate"><span class="pre">matplotlib</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="../intro-pandas.html">Introduction to <code class="docutils literal notranslate"><span class="pre">pandas</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="Problem01.01.html">Problem 1.1</a></li>

<li class="toctree-l1"><a class="reference internal" href="Problem01.03.html">Problem 1.3</a></li>
<li class="toctree-l1"><a class="reference internal" href="Problem01.04.html">Problem 1.4</a></li>
<li class="toctree-l1"><a class="reference internal" href="Problem01.05.html">Problem 1.5</a></li>
<li class="toctree-l1"><a class="reference internal" href="Problem02.01.html">Problem 2.1</a></li>
<li class="toctree-l1"><a class="reference internal" href="../intro-linopy.html">Introduction to <code class="docutils literal notranslate"><span class="pre">linopy</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="Problem02.02.html">Problem 2.2</a></li>
<li class="toctree-l1"><a class="reference internal" href="Problem02.03.html">Problem 2.3</a></li>
<li class="toctree-l1"><a class="reference internal" href="Problem03.01.html">Problem 3.1</a></li>
<li class="toctree-l1"><a class="reference internal" href="Problem03.02.html">Problem 3.2</a></li>
<li class="toctree-l1"><a class="reference internal" href="../intro-networkx.html">Introduction to <code class="docutils literal notranslate"><span class="pre">networkx</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="Problem03.03.html">Problem 3.3</a></li>
<li class="toctree-l1"><a class="reference internal" href="Problem03.04.html">Problem 3.4</a></li>
<li class="toctree-l1"><a class="reference internal" href="../intro-pypsa.html">Introduction to <code class="docutils literal notranslate"><span class="pre">pypsa</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="Problem04.01.html">Problem 4.1</a></li>
<li class="toctree-l1"><a class="reference internal" href="Problem04.02.html">Problem 4.2</a></li>
<li class="toctree-l1"><a class="reference internal" href="Problem04.03.html">Problem 4.3</a></li>
<li class="toctree-l1"><a class="reference internal" href="Problem04.04.html">Problem 4.4</a></li>
<li class="toctree-l1"><a class="reference internal" href="Problem05.01.html">Problem 5.1</a></li>
<li class="toctree-l1"><a class="reference internal" href="Problem05.02.html">Problem 5.2</a></li>
<li class="toctree-l1"><a class="reference internal" href="Problem05.03.html">Problem 5.3</a></li>
<li class="toctree-l1"><a class="reference internal" href="Problem05.04.html">Problem 5.4</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Problem 6.1</a></li>
<li class="toctree-l1"><a class="reference internal" href="Problem06.02.html">Problem 6.2</a></li>
<li class="toctree-l1"><a class="reference internal" href="../intro-gurobipy.html">Introduction to <code class="docutils literal notranslate"><span class="pre">gurobipy</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="Problem06.03.html">Problem 6.3</a></li>
<li class="toctree-l1"><a class="reference internal" href="Problem07.01.html">Problem 7.1</a></li>
<li class="toctree-l1"><a class="reference internal" href="Problem07.02.html">Problem 7.2</a></li>
<li class="toctree-l1"><a class="reference internal" href="Problem07.03.html">Problem 7.3</a></li>
<li class="toctree-l1"><a class="reference internal" href="Problem07.04.html">Problem 7.4</a></li>
<li class="toctree-l1"><a class="reference internal" href="Problem08.01.html">Problem 8.1</a></li>
<li class="toctree-l1"><a class="reference internal" href="Problem08.02.html">Problem 8.2</a></li>
<li class="toctree-l1"><a class="reference internal" href="Problem09.02.html">Problem 9.1</a></li>
<li class="toctree-l1"><a class="reference internal" href="Problem09.03.html">Problem 9.3</a></li>
<li class="toctree-l1"><a class="reference internal" href="IEG_course_project.html">Course project</a></li>


</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-launch-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Launch interactive content">
    <i class="fas fa-rocket"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://colab.research.google.com/github/martavp/integrated-energy-grids/blob/main/integrated-energy-grids/Problems/Problem06.01.ipynb" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch on Colab"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img alt="Colab logo" src="../_static/images/logo_colab.png">
  </span>
<span class="btn__text-container">Colab</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/martavp/integrated-energy-grids" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/martavp/integrated-energy-grids/issues/new?title=Issue%20on%20page%20%2FProblems/Problem06.01.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/Problems/Problem06.01.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>

</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Problem 6.1</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="problem-6-1">
<h1>Problem 6.1<a class="headerlink" href="#problem-6-1" title="Link to this heading">#</a></h1>
<p><strong>Integrated Energy Grids</strong></p>
<p><strong>Problem 6.1</strong></p>
<p><strong>Consider the simplified network plotted in Fig. 1, which represents Denmark and its neighbouring countries. Assume that the nodes are connected using transmission methane gas pipelines.</strong></p>
<p><strong>(a) Calculate the capacity of every pipeline (in MW) assuming that they operate at a pressure <span class="math notranslate nohighlight">\(P\)</span>=50 bar, the average gas flow velocity is <span class="math notranslate nohighlight">\(u\)</span> = 15 m/s, the diameter of the pipes is <span class="math notranslate nohighlight">\(D\)</span> = 600mm and the energy content of methane is 50 GJ/tonne. To calculate the speed of sound in gas <span class="math notranslate nohighlight">\(c\)</span>, assume the universal gas constant <span class="math notranslate nohighlight">\(R\)</span>=8.314 J/molK, the molar mass of methane <span class="math notranslate nohighlight">\(M\)</span>=16 g/mol, compression factor <span class="math notranslate nohighlight">\(Z\)</span>=1.31, and temperature <span class="math notranslate nohighlight">\(T\)</span>=25<span class="math notranslate nohighlight">\(^{\circ}\)</span>C.</strong></p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If you have not yet set up Python on your computer, you can execute this tutorial in your browser via <a class="reference external" href="https://colab.research.google.com/">Google Colab</a>. Click on the rocket in the top right corner and launch “Colab”. If that doesn’t work download the <code class="docutils literal notranslate"><span class="pre">.ipynb</span></code> file and import it in <a class="reference external" href="https://colab.research.google.com/">Google Colab</a>.</p>
<p>Then install the following packages by executing the following command in a Jupyter cell at the top of the notebook.</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>!pip<span class="w"> </span>install<span class="w"> </span>numpy<span class="w"> </span>pypsa
</pre></div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pypsa</span>
</pre></div>
</div>
</div>
</div>
<p>The cross-sectional area <span class="math notranslate nohighlight">\(A\)</span> and the speed of sound in gas <span class="math notranslate nohighlight">\(c\)</span> can be calculated as</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">D</span> <span class="o">=</span> <span class="mf">0.6</span> <span class="c1"># m</span>
<span class="n">u</span> <span class="o">=</span> <span class="mi">15</span> <span class="c1"># m/s</span>
<span class="n">P</span> <span class="o">=</span> <span class="mi">50</span><span class="o">*</span><span class="mi">100000</span> <span class="c1">#Pa</span>
<span class="n">Z</span> <span class="o">=</span> <span class="mf">1.31</span>
<span class="n">R</span> <span class="o">=</span> <span class="mf">8.314</span> <span class="c1"># J/molK</span>
<span class="n">M</span> <span class="o">=</span> <span class="mf">0.016</span> <span class="c1"># Kg/mol</span>
<span class="n">T</span> <span class="o">=</span> <span class="mi">273</span><span class="o">+</span><span class="mi">25</span> <span class="c1"># K</span>
<span class="n">e</span> <span class="o">=</span> <span class="mi">50</span> <span class="c1"># GJ/tonne or MJ/kg</span>

<span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="p">(</span><span class="n">D</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span>
<span class="n">c</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">Z</span><span class="o">*</span><span class="n">R</span><span class="o">*</span><span class="n">T</span><span class="o">/</span><span class="n">M</span><span class="p">)</span>
<span class="n">c</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>np.float64(450.3900615022494)
</pre></div>
</div>
</div>
</div>
<p>The density can be calculated as</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">rho</span> <span class="o">=</span> <span class="n">P</span> <span class="o">/</span> <span class="n">c</span><span class="o">**</span><span class="mi">2</span>
<span class="n">rho</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>np.float64(24.648608512719843)
</pre></div>
</div>
</div>
</div>
<p>The capacity of every pipeline can be calculated as <span class="math notranslate nohighlight">\(Q = \rho A u e\)</span></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">capacity</span> <span class="o">=</span> <span class="n">rho</span><span class="o">*</span><span class="n">A</span><span class="o">*</span><span class="n">u</span><span class="o">*</span><span class="n">e</span>
<span class="n">capacity</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>np.float64(5226.922401172076)
</pre></div>
</div>
</div>
</div>
<p>So, we obtain that the capacity is aproximately 5.2 GW</p>
<p><strong>(b) Assuming steady-state conditions, use link elements in PyPSA to build a network like the one shown in Fig. 1.  Assume that, in the first time step,  in every node, there is a demand for 5 GWh of methane.  In the Norway node there is a gas generator with a marginal cost of 20 EUR/MWh<span class="math notranslate nohighlight">\(_{th}\)</span>. Calculate the optimal gas flows through the network and plot them.</strong></p>
<p>We start by creating the network object and adding the buses or nodes</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">network</span> <span class="o">=</span> <span class="n">pypsa</span><span class="o">.</span><span class="n">Network</span><span class="p">()</span>
<span class="n">nodes</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;DE&quot;</span><span class="p">,</span> <span class="s2">&quot;DK1&quot;</span><span class="p">,</span> <span class="s2">&quot;DK2&quot;</span><span class="p">,</span> <span class="s2">&quot;NO&quot;</span><span class="p">,</span> <span class="s2">&quot;SE&quot;</span><span class="p">]</span>
<span class="n">pos</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">],[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]]</span> <span class="c1"># We add the nodes&#39; position only to make the plot later look pretty</span>

<span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">node</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">nodes</span><span class="p">):</span>
    <span class="n">network</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s2">&quot;Bus&quot;</span><span class="p">,</span> 
                <span class="s2">&quot;bus </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">node</span><span class="p">),</span>
               <span class="n">x</span><span class="o">=</span><span class="n">pos</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span>
               <span class="n">y</span><span class="o">=</span><span class="n">pos</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span> 
<span class="n">network</span><span class="o">.</span><span class="n">buses</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>v_nom</th>
      <th>type</th>
      <th>x</th>
      <th>y</th>
      <th>carrier</th>
      <th>unit</th>
      <th>location</th>
      <th>v_mag_pu_set</th>
      <th>v_mag_pu_min</th>
      <th>v_mag_pu_max</th>
      <th>control</th>
      <th>generator</th>
      <th>sub_network</th>
    </tr>
    <tr>
      <th>Bus</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>bus DE</th>
      <td>1.0</td>
      <td></td>
      <td>0.0</td>
      <td>0.0</td>
      <td>AC</td>
      <td></td>
      <td></td>
      <td>1.0</td>
      <td>0.0</td>
      <td>inf</td>
      <td>PQ</td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>bus DK1</th>
      <td>1.0</td>
      <td></td>
      <td>0.0</td>
      <td>1.0</td>
      <td>AC</td>
      <td></td>
      <td></td>
      <td>1.0</td>
      <td>0.0</td>
      <td>inf</td>
      <td>PQ</td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>bus DK2</th>
      <td>1.0</td>
      <td></td>
      <td>1.0</td>
      <td>1.0</td>
      <td>AC</td>
      <td></td>
      <td></td>
      <td>1.0</td>
      <td>0.0</td>
      <td>inf</td>
      <td>PQ</td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>bus NO</th>
      <td>1.0</td>
      <td></td>
      <td>0.0</td>
      <td>2.0</td>
      <td>AC</td>
      <td></td>
      <td></td>
      <td>1.0</td>
      <td>0.0</td>
      <td>inf</td>
      <td>PQ</td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>bus SE</th>
      <td>1.0</td>
      <td></td>
      <td>1.0</td>
      <td>2.0</td>
      <td>AC</td>
      <td></td>
      <td></td>
      <td>1.0</td>
      <td>0.0</td>
      <td>inf</td>
      <td>PQ</td>
      <td></td>
      <td></td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>We add the links representing the gas pipelines</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">network</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s2">&quot;Link&quot;</span><span class="p">,</span><span class="s2">&quot;pipeline DE-DK1&quot;</span><span class="p">,</span> <span class="n">bus0</span> <span class="o">=</span> <span class="s2">&quot;bus DE&quot;</span><span class="p">,</span> <span class="n">bus1</span> <span class="o">=</span> <span class="s2">&quot;bus DK1&quot;</span><span class="p">,</span> <span class="n">p_nom</span> <span class="o">=</span> <span class="n">capacity</span><span class="p">,</span> <span class="n">p_min_pu</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span> <span class="c1">#p_min_pu makes the pipeline reversible</span>
<span class="n">network</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s2">&quot;Link&quot;</span><span class="p">,</span><span class="s2">&quot;pipeline DK1-DK2&quot;</span><span class="p">,</span> <span class="n">bus0</span> <span class="o">=</span> <span class="s2">&quot;bus DK1&quot;</span><span class="p">,</span> <span class="n">bus1</span> <span class="o">=</span> <span class="s2">&quot;bus DK2&quot;</span><span class="p">,</span> <span class="n">p_nom</span> <span class="o">=</span> <span class="n">capacity</span><span class="p">,</span> <span class="n">p_min_pu</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
<span class="n">network</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s2">&quot;Link&quot;</span><span class="p">,</span><span class="s2">&quot;pipeline DK1-NO&quot;</span><span class="p">,</span> <span class="n">bus0</span> <span class="o">=</span> <span class="s2">&quot;bus DK1&quot;</span><span class="p">,</span> <span class="n">bus1</span> <span class="o">=</span> <span class="s2">&quot;bus NO&quot;</span><span class="p">,</span> <span class="n">p_nom</span> <span class="o">=</span> <span class="n">capacity</span><span class="p">,</span> <span class="n">p_min_pu</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
<span class="n">network</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s2">&quot;Link&quot;</span><span class="p">,</span><span class="s2">&quot;pipeline DK1-SE&quot;</span><span class="p">,</span> <span class="n">bus0</span> <span class="o">=</span> <span class="s2">&quot;bus DK1&quot;</span><span class="p">,</span> <span class="n">bus1</span> <span class="o">=</span> <span class="s2">&quot;bus SE&quot;</span><span class="p">,</span> <span class="n">p_nom</span> <span class="o">=</span> <span class="n">capacity</span><span class="p">,</span> <span class="n">p_min_pu</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
<span class="n">network</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s2">&quot;Link&quot;</span><span class="p">,</span><span class="s2">&quot;pipeline DK2-SE&quot;</span><span class="p">,</span> <span class="n">bus0</span> <span class="o">=</span> <span class="s2">&quot;bus DK2&quot;</span><span class="p">,</span> <span class="n">bus1</span> <span class="o">=</span> <span class="s2">&quot;bus SE&quot;</span><span class="p">,</span> <span class="n">p_nom</span> <span class="o">=</span> <span class="n">capacity</span><span class="p">,</span> <span class="n">p_min_pu</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
<span class="n">network</span><span class="o">.</span><span class="n">links</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>bus0</th>
      <th>bus1</th>
      <th>type</th>
      <th>carrier</th>
      <th>efficiency</th>
      <th>active</th>
      <th>build_year</th>
      <th>lifetime</th>
      <th>p_nom</th>
      <th>p_nom_mod</th>
      <th>...</th>
      <th>shut_down_cost</th>
      <th>min_up_time</th>
      <th>min_down_time</th>
      <th>up_time_before</th>
      <th>down_time_before</th>
      <th>ramp_limit_up</th>
      <th>ramp_limit_down</th>
      <th>ramp_limit_start_up</th>
      <th>ramp_limit_shut_down</th>
      <th>p_nom_opt</th>
    </tr>
    <tr>
      <th>Link</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>pipeline DE-DK1</th>
      <td>bus DE</td>
      <td>bus DK1</td>
      <td></td>
      <td></td>
      <td>1.0</td>
      <td>True</td>
      <td>0</td>
      <td>inf</td>
      <td>5226.922401</td>
      <td>0.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>pipeline DK1-DK2</th>
      <td>bus DK1</td>
      <td>bus DK2</td>
      <td></td>
      <td></td>
      <td>1.0</td>
      <td>True</td>
      <td>0</td>
      <td>inf</td>
      <td>5226.922401</td>
      <td>0.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>pipeline DK1-NO</th>
      <td>bus DK1</td>
      <td>bus NO</td>
      <td></td>
      <td></td>
      <td>1.0</td>
      <td>True</td>
      <td>0</td>
      <td>inf</td>
      <td>5226.922401</td>
      <td>0.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>pipeline DK1-SE</th>
      <td>bus DK1</td>
      <td>bus SE</td>
      <td></td>
      <td></td>
      <td>1.0</td>
      <td>True</td>
      <td>0</td>
      <td>inf</td>
      <td>5226.922401</td>
      <td>0.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>pipeline DK2-SE</th>
      <td>bus DK2</td>
      <td>bus SE</td>
      <td></td>
      <td></td>
      <td>1.0</td>
      <td>True</td>
      <td>0</td>
      <td>inf</td>
      <td>5226.922401</td>
      <td>0.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>0.0</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 34 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">nodes</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&#39;DE&#39;, &#39;DK1&#39;, &#39;DK2&#39;, &#39;NO&#39;, &#39;SE&#39;]
</pre></div>
</div>
</div>
</div>
<p>We add the loads and generator</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">node</span> <span class="ow">in</span> <span class="n">nodes</span><span class="p">:</span>
    <span class="n">network</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s2">&quot;Load&quot;</span><span class="p">,</span> 
                <span class="s2">&quot;gas demand </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">node</span><span class="p">),</span> 
                 <span class="n">bus</span><span class="o">=</span><span class="s2">&quot;bus </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">node</span><span class="p">),</span> 
                 <span class="n">p_set</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span> <span class="c1">#demand 1GWh = 1,000 MWh</span>
<span class="n">network</span><span class="o">.</span><span class="n">loads</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>bus</th>
      <th>carrier</th>
      <th>type</th>
      <th>p_set</th>
      <th>q_set</th>
      <th>sign</th>
      <th>active</th>
    </tr>
    <tr>
      <th>Load</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>gas demand DE</th>
      <td>bus DE</td>
      <td></td>
      <td></td>
      <td>1000.0</td>
      <td>0.0</td>
      <td>-1.0</td>
      <td>True</td>
    </tr>
    <tr>
      <th>gas demand DK1</th>
      <td>bus DK1</td>
      <td></td>
      <td></td>
      <td>1000.0</td>
      <td>0.0</td>
      <td>-1.0</td>
      <td>True</td>
    </tr>
    <tr>
      <th>gas demand DK2</th>
      <td>bus DK2</td>
      <td></td>
      <td></td>
      <td>1000.0</td>
      <td>0.0</td>
      <td>-1.0</td>
      <td>True</td>
    </tr>
    <tr>
      <th>gas demand NO</th>
      <td>bus NO</td>
      <td></td>
      <td></td>
      <td>1000.0</td>
      <td>0.0</td>
      <td>-1.0</td>
      <td>True</td>
    </tr>
    <tr>
      <th>gas demand SE</th>
      <td>bus SE</td>
      <td></td>
      <td></td>
      <td>1000.0</td>
      <td>0.0</td>
      <td>-1.0</td>
      <td>True</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">network</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s2">&quot;Generator&quot;</span><span class="p">,</span> 
            <span class="s2">&quot;gas&quot;</span><span class="p">,</span> 
            <span class="n">bus</span><span class="o">=</span><span class="s2">&quot;bus NO&quot;</span><span class="p">,</span> 
            <span class="n">p_nom</span><span class="o">=</span><span class="mi">10000</span><span class="p">,</span>  <span class="c1">#not relevant, just set it so that it is not limiting</span>
            <span class="n">marginal_cost</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span> <span class="c1">#EUR/MWh_th</span>
<span class="n">network</span><span class="o">.</span><span class="n">generators</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>bus</th>
      <th>control</th>
      <th>type</th>
      <th>p_nom</th>
      <th>p_nom_mod</th>
      <th>p_nom_extendable</th>
      <th>p_nom_min</th>
      <th>p_nom_max</th>
      <th>p_min_pu</th>
      <th>p_max_pu</th>
      <th>...</th>
      <th>min_up_time</th>
      <th>min_down_time</th>
      <th>up_time_before</th>
      <th>down_time_before</th>
      <th>ramp_limit_up</th>
      <th>ramp_limit_down</th>
      <th>ramp_limit_start_up</th>
      <th>ramp_limit_shut_down</th>
      <th>weight</th>
      <th>p_nom_opt</th>
    </tr>
    <tr>
      <th>Generator</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>gas</th>
      <td>bus NO</td>
      <td>PQ</td>
      <td></td>
      <td>10000.0</td>
      <td>0.0</td>
      <td>False</td>
      <td>0.0</td>
      <td>inf</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>0.0</td>
    </tr>
  </tbody>
</table>
<p>1 rows × 37 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">network</span><span class="o">.</span><span class="n">optimize</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>WARNING:pypsa.consistency:The following links have carriers which are not defined:
Index([&#39;pipeline DE-DK1&#39;, &#39;pipeline DK1-DK2&#39;, &#39;pipeline DK1-NO&#39;,
       &#39;pipeline DK1-SE&#39;, &#39;pipeline DK2-SE&#39;],
      dtype=&#39;object&#39;, name=&#39;Link&#39;)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>WARNING:pypsa.consistency:The following buses have carriers which are not defined:
Index([&#39;bus DE&#39;, &#39;bus DK1&#39;, &#39;bus DK2&#39;, &#39;bus NO&#39;, &#39;bus SE&#39;], dtype=&#39;object&#39;, name=&#39;Bus&#39;)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>INFO:linopy.model: Solve problem using Highs solver
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>INFO:linopy.io: Writing time: 0.02s
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>INFO:linopy.constants: Optimization successful: 
Status: ok
Termination condition: optimal
Solution: 6 primals, 17 duals
Objective: 1.00e+05
Solver model: available
Solver message: Optimal
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>INFO:pypsa.optimization.optimize:The shadow-prices of the constraints Generator-fix-p-lower, Generator-fix-p-upper, Link-fix-p-lower, Link-fix-p-upper were not assigned to the network.
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Running HiGHS 1.10.0 (git hash: fd86653): Copyright (c) 2025 HiGHS under MIT licence terms
LP   linopy-problem-d6ix_5ts has 17 rows; 6 cols; 23 nonzeros
Coefficient ranges:
  Matrix [1e+00, 1e+00]
  Cost   [2e+01, 2e+01]
  Bound  [0e+00, 0e+00]
  RHS    [1e+03, 1e+04]
Presolving model
0 rows, 0 cols, 0 nonzeros  0s
0 rows, 0 cols, 0 nonzeros  0s
Presolve : Reductions: rows 0(-17); columns 0(-6); elements 0(-23) - Reduced to empty
Solving the original LP from the solution after postsolve
Model name          : linopy-problem-d6ix_5ts
Model status        : Optimal
Objective value     :  1.0000000000e+05
Relative P-D gap    :  0.0000000000e+00
HiGHS run time      :          0.00
Writing the solution to /tmp/linopy-solve-9tvt84di.sol
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(&#39;ok&#39;, &#39;optimal&#39;)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">network</span><span class="o">.</span><span class="n">generators_t</span><span class="o">.</span><span class="n">p</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>Generator</th>
      <th>gas</th>
    </tr>
    <tr>
      <th>snapshot</th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>now</th>
      <td>5000.0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">gas_flows</span><span class="o">=</span><span class="n">network</span><span class="o">.</span><span class="n">links_t</span><span class="o">.</span><span class="n">p0</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;now&#39;</span><span class="p">]</span><span class="o">/</span><span class="mi">1000</span> <span class="c1">#MWh-&gt;GWh</span>
<span class="n">gas_flows</span> 
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Link
pipeline DE-DK1    -1.000000
pipeline DK1-DK2   -3.226922
pipeline DK1-NO    -4.000000
pipeline DK1-SE     5.226922
pipeline DK2-SE    -4.226922
Name: now, dtype: float64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">network</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
    <span class="n">margin</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
    <span class="n">bus_colors</span><span class="o">=</span><span class="s2">&quot;orange&quot;</span><span class="p">,</span>
    <span class="n">bus_alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span>
    <span class="n">color_geomap</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">link_widths</span><span class="o">=</span><span class="nb">abs</span><span class="p">(</span><span class="n">gas_flows</span><span class="p">),</span>
    <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Gas flows&quot;</span><span class="p">,</span>
<span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/tmp/ipykernel_2482/3962336250.py:1: DeprecatedWarning: plot is deprecated. Use `n.plot.map()` as a drop-in replacement instead.
  network.plot(
/opt/hostedtoolcache/Python/3.11.12/x64/lib/python3.11/site-packages/pypsa/plot/accessor.py:34: DeprecationWarning: `color_geomap` is deprecated as an argument to `plot`; use `geomap_colors` instead.
  return plot(self.n, *args, **kwargs)
/opt/hostedtoolcache/Python/3.11.12/x64/lib/python3.11/site-packages/cartopy/io/__init__.py:241: DownloadWarning: Downloading: https://naturalearth.s3.amazonaws.com/50m_physical/ne_50m_land.zip
  warnings.warn(f&#39;Downloading: {url}&#39;, DownloadWarning)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/opt/hostedtoolcache/Python/3.11.12/x64/lib/python3.11/site-packages/cartopy/io/__init__.py:241: DownloadWarning: Downloading: https://naturalearth.s3.amazonaws.com/50m_physical/ne_50m_ocean.zip
  warnings.warn(f&#39;Downloading: {url}&#39;, DownloadWarning)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/opt/hostedtoolcache/Python/3.11.12/x64/lib/python3.11/site-packages/cartopy/io/__init__.py:241: DownloadWarning: Downloading: https://naturalearth.s3.amazonaws.com/50m_cultural/ne_50m_admin_0_boundary_lines_land.zip
  warnings.warn(f&#39;Downloading: {url}&#39;, DownloadWarning)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/opt/hostedtoolcache/Python/3.11.12/x64/lib/python3.11/site-packages/cartopy/io/__init__.py:241: DownloadWarning: Downloading: https://naturalearth.s3.amazonaws.com/50m_physical/ne_50m_coastline.zip
  warnings.warn(f&#39;Downloading: {url}&#39;, DownloadWarning)
</pre></div>
</div>
<img alt="../_images/45c7deb3f29decfc90f278d2b1a6c9f33d28bbfcf4d948ff5cb92d82e9b27c58.png" src="../_images/45c7deb3f29decfc90f278d2b1a6c9f33d28bbfcf4d948ff5cb92d82e9b27c58.png" />
</div>
</div>
<p><strong>(c) Assume the following lengths for the links: DK1-DK2=200 km, DK1-DE=600 km, DK1-NO= 500 km, DK1-SE=600 km, DK2-SE=100 km. If we consider that the losses due to energy consumption of the compressors’ to maintain the pressure can be estimated at 2% of the energy flow per 1000 km. Adapt the link elements in PyPSA to include an efficiency that takes compressors’ energy demand into account. calculate the optimal gas flows through the network and plot them.</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">losses_per_1000km</span> <span class="o">=</span> <span class="mf">0.02</span> <span class="c1">#%</span>
</pre></div>
</div>
</div>
</div>
<p>Since we want to represent losses by imposing a certain efficiency in the links, we can not anymore define them as reversible by making <code class="docutils literal notranslate"><span class="pre">p_min_pu=-1</span></code> and we need to duplicate and reverse the links.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">network</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s2">&quot;Link&quot;</span><span class="p">,</span><span class="s2">&quot;pipeline DE-DK1&quot;</span><span class="p">,</span> <span class="n">bus0</span> <span class="o">=</span> <span class="s2">&quot;bus DE&quot;</span><span class="p">,</span> <span class="n">bus1</span> <span class="o">=</span> <span class="s2">&quot;bus DK1&quot;</span><span class="p">,</span> <span class="n">efficiency</span> <span class="o">=</span> <span class="mi">1</span><span class="o">-</span><span class="mi">600</span><span class="o">/</span><span class="mi">1000</span><span class="o">*</span><span class="n">losses_per_1000km</span><span class="p">,</span> <span class="n">overwrite</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">p_nom</span> <span class="o">=</span> <span class="n">capacity</span><span class="p">)</span> 
<span class="n">network</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s2">&quot;Link&quot;</span><span class="p">,</span><span class="s2">&quot;pipeline DK1-DK2&quot;</span><span class="p">,</span> <span class="n">bus0</span> <span class="o">=</span> <span class="s2">&quot;bus DK1&quot;</span><span class="p">,</span> <span class="n">bus1</span> <span class="o">=</span> <span class="s2">&quot;bus DK2&quot;</span><span class="p">,</span> <span class="n">efficiency</span> <span class="o">=</span> <span class="mi">1</span><span class="o">-</span><span class="mi">200</span><span class="o">/</span><span class="mi">1000</span><span class="o">*</span><span class="n">losses_per_1000km</span><span class="p">,</span> <span class="n">overwrite</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">p_nom</span> <span class="o">=</span> <span class="n">capacity</span><span class="p">)</span>
<span class="n">network</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s2">&quot;Link&quot;</span><span class="p">,</span><span class="s2">&quot;pipeline DK1-NO&quot;</span><span class="p">,</span> <span class="n">bus0</span> <span class="o">=</span> <span class="s2">&quot;bus DK1&quot;</span><span class="p">,</span> <span class="n">bus1</span> <span class="o">=</span> <span class="s2">&quot;bus NO&quot;</span><span class="p">,</span> <span class="n">efficiency</span> <span class="o">=</span> <span class="mi">1</span><span class="o">-</span><span class="mi">500</span><span class="o">/</span><span class="mi">1000</span><span class="o">*</span><span class="n">losses_per_1000km</span><span class="p">,</span> <span class="n">overwrite</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">p_nom</span> <span class="o">=</span> <span class="n">capacity</span><span class="p">)</span>
<span class="n">network</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s2">&quot;Link&quot;</span><span class="p">,</span><span class="s2">&quot;pipeline DK1-SE&quot;</span><span class="p">,</span> <span class="n">bus0</span> <span class="o">=</span> <span class="s2">&quot;bus DK1&quot;</span><span class="p">,</span> <span class="n">bus1</span> <span class="o">=</span> <span class="s2">&quot;bus SE&quot;</span><span class="p">,</span> <span class="n">efficiency</span> <span class="o">=</span> <span class="mi">1</span><span class="o">-</span><span class="mi">600</span><span class="o">/</span><span class="mi">1000</span><span class="o">*</span><span class="n">losses_per_1000km</span><span class="p">,</span> <span class="n">overwrite</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">p_nom</span> <span class="o">=</span> <span class="n">capacity</span><span class="p">)</span>
<span class="n">network</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s2">&quot;Link&quot;</span><span class="p">,</span><span class="s2">&quot;pipeline DK2-SE&quot;</span><span class="p">,</span> <span class="n">bus0</span> <span class="o">=</span> <span class="s2">&quot;bus DK2&quot;</span><span class="p">,</span> <span class="n">bus1</span> <span class="o">=</span> <span class="s2">&quot;bus SE&quot;</span><span class="p">,</span> <span class="n">efficiency</span> <span class="o">=</span> <span class="mi">1</span><span class="o">-</span><span class="mi">100</span><span class="o">/</span><span class="mi">1000</span><span class="o">*</span><span class="n">losses_per_1000km</span><span class="p">,</span> <span class="n">overwrite</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">p_nom</span> <span class="o">=</span> <span class="n">capacity</span><span class="p">)</span>

<span class="n">network</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s2">&quot;Link&quot;</span><span class="p">,</span><span class="s2">&quot;pipeline DK1-DE&quot;</span><span class="p">,</span> <span class="n">bus1</span> <span class="o">=</span> <span class="s2">&quot;bus DE&quot;</span><span class="p">,</span> <span class="n">bus0</span> <span class="o">=</span> <span class="s2">&quot;bus DK1&quot;</span><span class="p">,</span> <span class="n">efficiency</span> <span class="o">=</span> <span class="mi">1</span><span class="o">-</span><span class="mi">600</span><span class="o">/</span><span class="mi">1000</span><span class="o">*</span><span class="n">losses_per_1000km</span><span class="p">,</span> <span class="n">overwrite</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">p_nom</span> <span class="o">=</span> <span class="n">capacity</span><span class="p">)</span> 
<span class="n">network</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s2">&quot;Link&quot;</span><span class="p">,</span><span class="s2">&quot;pipeline DK2-DK1&quot;</span><span class="p">,</span> <span class="n">bus1</span> <span class="o">=</span> <span class="s2">&quot;bus DK1&quot;</span><span class="p">,</span> <span class="n">bus0</span> <span class="o">=</span> <span class="s2">&quot;bus DK2&quot;</span><span class="p">,</span> <span class="n">efficiency</span> <span class="o">=</span> <span class="mi">1</span><span class="o">-</span><span class="mi">200</span><span class="o">/</span><span class="mi">1000</span><span class="o">*</span><span class="n">losses_per_1000km</span><span class="p">,</span> <span class="n">overwrite</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">p_nom</span> <span class="o">=</span> <span class="n">capacity</span><span class="p">)</span>
<span class="n">network</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s2">&quot;Link&quot;</span><span class="p">,</span><span class="s2">&quot;pipeline NO-DK1&quot;</span><span class="p">,</span> <span class="n">bus1</span> <span class="o">=</span> <span class="s2">&quot;bus DK1&quot;</span><span class="p">,</span> <span class="n">bus0</span> <span class="o">=</span> <span class="s2">&quot;bus NO&quot;</span><span class="p">,</span> <span class="n">efficiency</span> <span class="o">=</span> <span class="mi">1</span><span class="o">-</span><span class="mi">500</span><span class="o">/</span><span class="mi">1000</span><span class="o">*</span><span class="n">losses_per_1000km</span><span class="p">,</span> <span class="n">overwrite</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">p_nom</span> <span class="o">=</span> <span class="n">capacity</span><span class="p">)</span>
<span class="n">network</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s2">&quot;Link&quot;</span><span class="p">,</span><span class="s2">&quot;pipeline SE-DK1&quot;</span><span class="p">,</span> <span class="n">bus1</span> <span class="o">=</span> <span class="s2">&quot;bus DK1&quot;</span><span class="p">,</span> <span class="n">bus0</span> <span class="o">=</span> <span class="s2">&quot;bus SE&quot;</span><span class="p">,</span> <span class="n">efficiency</span> <span class="o">=</span> <span class="mi">1</span><span class="o">-</span><span class="mi">600</span><span class="o">/</span><span class="mi">1000</span><span class="o">*</span><span class="n">losses_per_1000km</span><span class="p">,</span> <span class="n">overwrite</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">p_nom</span> <span class="o">=</span> <span class="n">capacity</span><span class="p">)</span>
<span class="n">network</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s2">&quot;Link&quot;</span><span class="p">,</span><span class="s2">&quot;pipeline SE-DK2&quot;</span><span class="p">,</span> <span class="n">bus1</span> <span class="o">=</span> <span class="s2">&quot;bus DK2&quot;</span><span class="p">,</span> <span class="n">bus0</span> <span class="o">=</span> <span class="s2">&quot;bus SE&quot;</span><span class="p">,</span> <span class="n">efficiency</span> <span class="o">=</span> <span class="mi">1</span><span class="o">-</span><span class="mi">100</span><span class="o">/</span><span class="mi">1000</span><span class="o">*</span><span class="n">losses_per_1000km</span><span class="p">,</span> <span class="n">overwrite</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">p_nom</span> <span class="o">=</span> <span class="n">capacity</span><span class="p">)</span>

<span class="n">network</span><span class="o">.</span><span class="n">links</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>bus0</th>
      <th>bus1</th>
      <th>type</th>
      <th>carrier</th>
      <th>efficiency</th>
      <th>active</th>
      <th>build_year</th>
      <th>lifetime</th>
      <th>p_nom</th>
      <th>p_nom_mod</th>
      <th>...</th>
      <th>shut_down_cost</th>
      <th>min_up_time</th>
      <th>min_down_time</th>
      <th>up_time_before</th>
      <th>down_time_before</th>
      <th>ramp_limit_up</th>
      <th>ramp_limit_down</th>
      <th>ramp_limit_start_up</th>
      <th>ramp_limit_shut_down</th>
      <th>p_nom_opt</th>
    </tr>
    <tr>
      <th>Link</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>pipeline DE-DK1</th>
      <td>bus DE</td>
      <td>bus DK1</td>
      <td></td>
      <td></td>
      <td>0.988</td>
      <td>True</td>
      <td>0</td>
      <td>inf</td>
      <td>5226.922401</td>
      <td>0.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>pipeline DK1-DK2</th>
      <td>bus DK1</td>
      <td>bus DK2</td>
      <td></td>
      <td></td>
      <td>0.996</td>
      <td>True</td>
      <td>0</td>
      <td>inf</td>
      <td>5226.922401</td>
      <td>0.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>pipeline DK1-NO</th>
      <td>bus DK1</td>
      <td>bus NO</td>
      <td></td>
      <td></td>
      <td>0.990</td>
      <td>True</td>
      <td>0</td>
      <td>inf</td>
      <td>5226.922401</td>
      <td>0.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>pipeline DK1-SE</th>
      <td>bus DK1</td>
      <td>bus SE</td>
      <td></td>
      <td></td>
      <td>0.988</td>
      <td>True</td>
      <td>0</td>
      <td>inf</td>
      <td>5226.922401</td>
      <td>0.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>pipeline DK2-SE</th>
      <td>bus DK2</td>
      <td>bus SE</td>
      <td></td>
      <td></td>
      <td>0.998</td>
      <td>True</td>
      <td>0</td>
      <td>inf</td>
      <td>5226.922401</td>
      <td>0.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>pipeline DK1-DE</th>
      <td>bus DK1</td>
      <td>bus DE</td>
      <td></td>
      <td></td>
      <td>0.988</td>
      <td>True</td>
      <td>0</td>
      <td>inf</td>
      <td>5226.922401</td>
      <td>0.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>pipeline DK2-DK1</th>
      <td>bus DK2</td>
      <td>bus DK1</td>
      <td></td>
      <td></td>
      <td>0.996</td>
      <td>True</td>
      <td>0</td>
      <td>inf</td>
      <td>5226.922401</td>
      <td>0.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>pipeline NO-DK1</th>
      <td>bus NO</td>
      <td>bus DK1</td>
      <td></td>
      <td></td>
      <td>0.990</td>
      <td>True</td>
      <td>0</td>
      <td>inf</td>
      <td>5226.922401</td>
      <td>0.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>pipeline SE-DK1</th>
      <td>bus SE</td>
      <td>bus DK1</td>
      <td></td>
      <td></td>
      <td>0.988</td>
      <td>True</td>
      <td>0</td>
      <td>inf</td>
      <td>5226.922401</td>
      <td>0.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>pipeline SE-DK2</th>
      <td>bus SE</td>
      <td>bus DK2</td>
      <td></td>
      <td></td>
      <td>0.998</td>
      <td>True</td>
      <td>0</td>
      <td>inf</td>
      <td>5226.922401</td>
      <td>0.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>0.0</td>
    </tr>
  </tbody>
</table>
<p>10 rows × 34 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">network</span><span class="o">.</span><span class="n">optimize</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>WARNING:pypsa.consistency:The following links have carriers which are not defined:
Index([&#39;pipeline DE-DK1&#39;, &#39;pipeline DK1-DK2&#39;, &#39;pipeline DK1-NO&#39;,
       &#39;pipeline DK1-SE&#39;, &#39;pipeline DK2-SE&#39;, &#39;pipeline DK1-DE&#39;,
       &#39;pipeline DK2-DK1&#39;, &#39;pipeline NO-DK1&#39;, &#39;pipeline SE-DK1&#39;,
       &#39;pipeline SE-DK2&#39;],
      dtype=&#39;object&#39;, name=&#39;Link&#39;)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>WARNING:pypsa.consistency:The following buses have carriers which are not defined:
Index([&#39;bus DE&#39;, &#39;bus DK1&#39;, &#39;bus DK2&#39;, &#39;bus NO&#39;, &#39;bus SE&#39;], dtype=&#39;object&#39;, name=&#39;Bus&#39;)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>INFO:linopy.model: Solve problem using Highs solver
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>INFO:linopy.io: Writing time: 0.02s
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>INFO:linopy.constants: Optimization successful: 
Status: ok
Termination condition: optimal
Solution: 11 primals, 27 duals
Objective: 1.01e+05
Solver model: available
Solver message: Optimal
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>INFO:pypsa.optimization.optimize:The shadow-prices of the constraints Generator-fix-p-lower, Generator-fix-p-upper, Link-fix-p-lower, Link-fix-p-upper were not assigned to the network.
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Running HiGHS 1.10.0 (git hash: fd86653): Copyright (c) 2025 HiGHS under MIT licence terms
LP   linopy-problem-qgu1ag3b has 27 rows; 11 cols; 43 nonzeros
Coefficient ranges:
  Matrix [1e+00, 1e+00]
  Cost   [2e+01, 2e+01]
  Bound  [0e+00, 0e+00]
  RHS    [1e+03, 1e+04]
Presolving model
4 rows, 10 cols, 18 nonzeros  0s
Dependent equations search running on 4 equations with time limit of 1000.00s
Dependent equations search removed 0 rows and 0 nonzeros in 0.00s (limit = 1000.00s)
4 rows, 10 cols, 18 nonzeros  0s
Presolve : Reductions: rows 4(-23); columns 10(-1); elements 18(-25)
Solving the presolved LP
Using EKK dual simplex solver - serial
  Iteration        Objective     Infeasibilities num(sum)
          0     5.0487388926e-04 Pr: 4(5012.15) 0s
          6     1.0125636230e+05 Pr: 0(0) 0s
Solving the original LP from the solution after postsolve
Model name          : linopy-problem-qgu1ag3b
Model status        : Optimal
Simplex   iterations: 6
Objective value     :  1.0125636230e+05
Relative P-D gap    :  0.0000000000e+00
HiGHS run time      :          0.00
Writing the solution to /tmp/linopy-solve-l6enay8v.sol
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(&#39;ok&#39;, &#39;optimal&#39;)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">network</span><span class="o">.</span><span class="n">generators_t</span><span class="o">.</span><span class="n">p</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>Generator</th>
      <th>gas</th>
    </tr>
    <tr>
      <th>snapshot</th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>now</th>
      <td>5062.818115</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">gas_flows</span><span class="o">=</span><span class="n">network</span><span class="o">.</span><span class="n">links_t</span><span class="o">.</span><span class="n">p0</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;now&#39;</span><span class="p">]</span><span class="o">/</span><span class="mi">1000</span> <span class="c1">#MWh-&gt;GWh</span>
<span class="n">gas_flows</span> 
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Link
pipeline DE-DK1    -0.000000
pipeline DK1-DK2    2.010044
pipeline DK1-NO    -0.000000
pipeline DK1-SE    -0.000000
pipeline DK2-SE     1.002004
pipeline DK1-DE     1.012146
pipeline DK2-DK1   -0.000000
pipeline NO-DK1     4.062818
pipeline SE-DK1    -0.000000
pipeline SE-DK2    -0.000000
Name: now, dtype: float64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">network</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
    <span class="n">margin</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
    <span class="n">bus_colors</span><span class="o">=</span><span class="s2">&quot;orange&quot;</span><span class="p">,</span>
    <span class="n">bus_alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span>
    <span class="n">color_geomap</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">link_widths</span><span class="o">=</span><span class="n">gas_flows</span><span class="p">,</span>
    <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Gas flows&quot;</span><span class="p">,</span>
<span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/tmp/ipykernel_2482/526667820.py:1: DeprecatedWarning: plot is deprecated. Use `n.plot.map()` as a drop-in replacement instead.
  network.plot(
/opt/hostedtoolcache/Python/3.11.12/x64/lib/python3.11/site-packages/pypsa/plot/accessor.py:34: DeprecationWarning: `color_geomap` is deprecated as an argument to `plot`; use `geomap_colors` instead.
  return plot(self.n, *args, **kwargs)
</pre></div>
</div>
<img alt="../_images/9401af66a5f435d4d57f9aa04c30a4e69bb2cf357f5b5e65d011460fdc3b7554.png" src="../_images/9401af66a5f435d4d57f9aa04c30a4e69bb2cf357f5b5e65d011460fdc3b7554.png" />
</div>
</div>
<p><strong>(d) Assuming the following demands in GWh for three consecutive time steps DE=[0,0,3], DK1=[1,2,1], DK2=[1,1,1], NO=[1,1,1], SE=[0,1,0]. Calculate the optimal flows in every time step and the total system costs.</strong></p>
<p>We create the network again but this time with 3 time steps.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">network</span><span class="o">=</span><span class="n">pypsa</span><span class="o">.</span><span class="n">Network</span><span class="p">(</span><span class="n">snapshots</span><span class="o">=</span><span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>

<span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">node</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">nodes</span><span class="p">):</span>
    <span class="n">network</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s2">&quot;Bus&quot;</span><span class="p">,</span> 
                <span class="s2">&quot;bus </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">node</span><span class="p">),</span>
               <span class="n">x</span><span class="o">=</span><span class="n">pos</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span>
               <span class="n">y</span><span class="o">=</span><span class="n">pos</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span> 

<span class="n">network</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s2">&quot;Generator&quot;</span><span class="p">,</span> 
            <span class="s2">&quot;gas&quot;</span><span class="p">,</span> 
            <span class="n">bus</span><span class="o">=</span><span class="s2">&quot;bus NO&quot;</span><span class="p">,</span> 
            <span class="n">p_nom</span><span class="o">=</span><span class="mi">100000</span><span class="p">,</span>  <span class="c1">#not relevant, just set so that it is not limiting</span>
            <span class="n">marginal_cost</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span> <span class="c1">#EUR/MWh_th</span>


<span class="n">network</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s2">&quot;Link&quot;</span><span class="p">,</span><span class="s2">&quot;pipeline DE-DK1&quot;</span><span class="p">,</span> <span class="n">bus0</span> <span class="o">=</span> <span class="s2">&quot;bus DE&quot;</span><span class="p">,</span> <span class="n">bus1</span> <span class="o">=</span> <span class="s2">&quot;bus DK1&quot;</span><span class="p">,</span> <span class="n">efficiency</span> <span class="o">=</span> <span class="mi">1</span><span class="o">-</span><span class="mi">600</span><span class="o">/</span><span class="mi">1000</span><span class="o">*</span><span class="n">losses_per_1000km</span><span class="p">,</span> <span class="n">overwrite</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">p_nom</span> <span class="o">=</span> <span class="n">capacity</span><span class="p">)</span> 
<span class="n">network</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s2">&quot;Link&quot;</span><span class="p">,</span><span class="s2">&quot;pipeline DK1-DK2&quot;</span><span class="p">,</span> <span class="n">bus0</span> <span class="o">=</span> <span class="s2">&quot;bus DK1&quot;</span><span class="p">,</span> <span class="n">bus1</span> <span class="o">=</span> <span class="s2">&quot;bus DK2&quot;</span><span class="p">,</span> <span class="n">efficiency</span> <span class="o">=</span> <span class="mi">1</span><span class="o">-</span><span class="mi">200</span><span class="o">/</span><span class="mi">1000</span><span class="o">*</span><span class="n">losses_per_1000km</span><span class="p">,</span> <span class="n">overwrite</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">p_nom</span> <span class="o">=</span> <span class="n">capacity</span><span class="p">)</span>
<span class="n">network</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s2">&quot;Link&quot;</span><span class="p">,</span><span class="s2">&quot;pipeline DK1-NO&quot;</span><span class="p">,</span> <span class="n">bus0</span> <span class="o">=</span> <span class="s2">&quot;bus DK1&quot;</span><span class="p">,</span> <span class="n">bus1</span> <span class="o">=</span> <span class="s2">&quot;bus NO&quot;</span><span class="p">,</span> <span class="n">efficiency</span> <span class="o">=</span> <span class="mi">1</span><span class="o">-</span><span class="mi">500</span><span class="o">/</span><span class="mi">1000</span><span class="o">*</span><span class="n">losses_per_1000km</span><span class="p">,</span> <span class="n">overwrite</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">p_nom</span> <span class="o">=</span> <span class="n">capacity</span><span class="p">)</span>
<span class="n">network</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s2">&quot;Link&quot;</span><span class="p">,</span><span class="s2">&quot;pipeline DK1-SE&quot;</span><span class="p">,</span> <span class="n">bus0</span> <span class="o">=</span> <span class="s2">&quot;bus DK1&quot;</span><span class="p">,</span> <span class="n">bus1</span> <span class="o">=</span> <span class="s2">&quot;bus SE&quot;</span><span class="p">,</span> <span class="n">efficiency</span> <span class="o">=</span> <span class="mi">1</span><span class="o">-</span><span class="mi">600</span><span class="o">/</span><span class="mi">1000</span><span class="o">*</span><span class="n">losses_per_1000km</span><span class="p">,</span> <span class="n">overwrite</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">p_nom</span> <span class="o">=</span> <span class="n">capacity</span><span class="p">)</span>
<span class="n">network</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s2">&quot;Link&quot;</span><span class="p">,</span><span class="s2">&quot;pipeline DK2-SE&quot;</span><span class="p">,</span> <span class="n">bus0</span> <span class="o">=</span> <span class="s2">&quot;bus DK2&quot;</span><span class="p">,</span> <span class="n">bus1</span> <span class="o">=</span> <span class="s2">&quot;bus SE&quot;</span><span class="p">,</span> <span class="n">efficiency</span> <span class="o">=</span> <span class="mi">1</span><span class="o">-</span><span class="mi">100</span><span class="o">/</span><span class="mi">1000</span><span class="o">*</span><span class="n">losses_per_1000km</span><span class="p">,</span> <span class="n">overwrite</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">p_nom</span> <span class="o">=</span> <span class="n">capacity</span><span class="p">)</span>

<span class="n">network</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s2">&quot;Link&quot;</span><span class="p">,</span><span class="s2">&quot;pipeline DK1-DE&quot;</span><span class="p">,</span> <span class="n">bus1</span> <span class="o">=</span> <span class="s2">&quot;bus DE&quot;</span><span class="p">,</span> <span class="n">bus0</span> <span class="o">=</span> <span class="s2">&quot;bus DK1&quot;</span><span class="p">,</span> <span class="n">efficiency</span> <span class="o">=</span> <span class="mi">1</span><span class="o">-</span><span class="mi">600</span><span class="o">/</span><span class="mi">1000</span><span class="o">*</span><span class="n">losses_per_1000km</span><span class="p">,</span> <span class="n">overwrite</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">p_nom</span> <span class="o">=</span> <span class="n">capacity</span><span class="p">)</span> 
<span class="n">network</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s2">&quot;Link&quot;</span><span class="p">,</span><span class="s2">&quot;pipeline DK2-DK1&quot;</span><span class="p">,</span> <span class="n">bus1</span> <span class="o">=</span> <span class="s2">&quot;bus DK1&quot;</span><span class="p">,</span> <span class="n">bus0</span> <span class="o">=</span> <span class="s2">&quot;bus DK2&quot;</span><span class="p">,</span> <span class="n">efficiency</span> <span class="o">=</span> <span class="mi">1</span><span class="o">-</span><span class="mi">200</span><span class="o">/</span><span class="mi">1000</span><span class="o">*</span><span class="n">losses_per_1000km</span><span class="p">,</span> <span class="n">overwrite</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">p_nom</span> <span class="o">=</span> <span class="n">capacity</span><span class="p">)</span>
<span class="n">network</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s2">&quot;Link&quot;</span><span class="p">,</span><span class="s2">&quot;pipeline NO-DK1&quot;</span><span class="p">,</span> <span class="n">bus1</span> <span class="o">=</span> <span class="s2">&quot;bus DK1&quot;</span><span class="p">,</span> <span class="n">bus0</span> <span class="o">=</span> <span class="s2">&quot;bus NO&quot;</span><span class="p">,</span> <span class="n">efficiency</span> <span class="o">=</span> <span class="mi">1</span><span class="o">-</span><span class="mi">500</span><span class="o">/</span><span class="mi">1000</span><span class="o">*</span><span class="n">losses_per_1000km</span><span class="p">,</span> <span class="n">overwrite</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">p_nom</span> <span class="o">=</span> <span class="n">capacity</span><span class="p">)</span>
<span class="n">network</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s2">&quot;Link&quot;</span><span class="p">,</span><span class="s2">&quot;pipeline SE-DK1&quot;</span><span class="p">,</span> <span class="n">bus1</span> <span class="o">=</span> <span class="s2">&quot;bus DK1&quot;</span><span class="p">,</span> <span class="n">bus0</span> <span class="o">=</span> <span class="s2">&quot;bus SE&quot;</span><span class="p">,</span> <span class="n">efficiency</span> <span class="o">=</span> <span class="mi">1</span><span class="o">-</span><span class="mi">600</span><span class="o">/</span><span class="mi">1000</span><span class="o">*</span><span class="n">losses_per_1000km</span><span class="p">,</span> <span class="n">overwrite</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">p_nom</span> <span class="o">=</span> <span class="n">capacity</span><span class="p">)</span>
<span class="n">network</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s2">&quot;Link&quot;</span><span class="p">,</span><span class="s2">&quot;pipeline SE-DK2&quot;</span><span class="p">,</span> <span class="n">bus1</span> <span class="o">=</span> <span class="s2">&quot;bus DK2&quot;</span><span class="p">,</span> <span class="n">bus0</span> <span class="o">=</span> <span class="s2">&quot;bus SE&quot;</span><span class="p">,</span> <span class="n">efficiency</span> <span class="o">=</span> <span class="mi">1</span><span class="o">-</span><span class="mi">100</span><span class="o">/</span><span class="mi">1000</span><span class="o">*</span><span class="n">losses_per_1000km</span><span class="p">,</span> <span class="n">overwrite</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">p_nom</span> <span class="o">=</span> <span class="n">capacity</span><span class="p">)</span>
<span class="n">network</span><span class="o">.</span><span class="n">links</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>bus0</th>
      <th>bus1</th>
      <th>type</th>
      <th>carrier</th>
      <th>efficiency</th>
      <th>active</th>
      <th>build_year</th>
      <th>lifetime</th>
      <th>p_nom</th>
      <th>p_nom_mod</th>
      <th>...</th>
      <th>shut_down_cost</th>
      <th>min_up_time</th>
      <th>min_down_time</th>
      <th>up_time_before</th>
      <th>down_time_before</th>
      <th>ramp_limit_up</th>
      <th>ramp_limit_down</th>
      <th>ramp_limit_start_up</th>
      <th>ramp_limit_shut_down</th>
      <th>p_nom_opt</th>
    </tr>
    <tr>
      <th>Link</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>pipeline DE-DK1</th>
      <td>bus DE</td>
      <td>bus DK1</td>
      <td></td>
      <td></td>
      <td>0.988</td>
      <td>True</td>
      <td>0</td>
      <td>inf</td>
      <td>5226.922401</td>
      <td>0.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>pipeline DK1-DK2</th>
      <td>bus DK1</td>
      <td>bus DK2</td>
      <td></td>
      <td></td>
      <td>0.996</td>
      <td>True</td>
      <td>0</td>
      <td>inf</td>
      <td>5226.922401</td>
      <td>0.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>pipeline DK1-NO</th>
      <td>bus DK1</td>
      <td>bus NO</td>
      <td></td>
      <td></td>
      <td>0.990</td>
      <td>True</td>
      <td>0</td>
      <td>inf</td>
      <td>5226.922401</td>
      <td>0.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>pipeline DK1-SE</th>
      <td>bus DK1</td>
      <td>bus SE</td>
      <td></td>
      <td></td>
      <td>0.988</td>
      <td>True</td>
      <td>0</td>
      <td>inf</td>
      <td>5226.922401</td>
      <td>0.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>pipeline DK2-SE</th>
      <td>bus DK2</td>
      <td>bus SE</td>
      <td></td>
      <td></td>
      <td>0.998</td>
      <td>True</td>
      <td>0</td>
      <td>inf</td>
      <td>5226.922401</td>
      <td>0.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>pipeline DK1-DE</th>
      <td>bus DK1</td>
      <td>bus DE</td>
      <td></td>
      <td></td>
      <td>0.988</td>
      <td>True</td>
      <td>0</td>
      <td>inf</td>
      <td>5226.922401</td>
      <td>0.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>pipeline DK2-DK1</th>
      <td>bus DK2</td>
      <td>bus DK1</td>
      <td></td>
      <td></td>
      <td>0.996</td>
      <td>True</td>
      <td>0</td>
      <td>inf</td>
      <td>5226.922401</td>
      <td>0.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>pipeline NO-DK1</th>
      <td>bus NO</td>
      <td>bus DK1</td>
      <td></td>
      <td></td>
      <td>0.990</td>
      <td>True</td>
      <td>0</td>
      <td>inf</td>
      <td>5226.922401</td>
      <td>0.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>pipeline SE-DK1</th>
      <td>bus SE</td>
      <td>bus DK1</td>
      <td></td>
      <td></td>
      <td>0.988</td>
      <td>True</td>
      <td>0</td>
      <td>inf</td>
      <td>5226.922401</td>
      <td>0.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>pipeline SE-DK2</th>
      <td>bus SE</td>
      <td>bus DK2</td>
      <td></td>
      <td></td>
      <td>0.998</td>
      <td>True</td>
      <td>0</td>
      <td>inf</td>
      <td>5226.922401</td>
      <td>0.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>0.0</td>
    </tr>
  </tbody>
</table>
<p>10 rows × 34 columns</p>
</div></div></div>
</div>
<p>We add the load in every node.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">loads</span><span class="o">=</span><span class="p">[[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">3000</span><span class="p">],</span>
       <span class="p">[</span><span class="mi">1000</span><span class="p">,</span><span class="mi">2000</span><span class="p">,</span><span class="mi">1000</span><span class="p">],</span>
       <span class="p">[</span><span class="mi">1000</span><span class="p">,</span><span class="mi">1000</span><span class="p">,</span><span class="mi">1000</span><span class="p">],</span>       
       <span class="p">[</span><span class="mi">1000</span><span class="p">,</span><span class="mi">1000</span><span class="p">,</span><span class="mi">1000</span><span class="p">],</span>
       <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1000</span><span class="p">,</span><span class="mi">0</span><span class="p">]]</span>

<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">node</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">nodes</span><span class="p">):</span>
    <span class="n">network</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s2">&quot;Load&quot;</span><span class="p">,</span> 
                <span class="s2">&quot;gas demand </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">node</span><span class="p">),</span> 
                 <span class="n">bus</span><span class="o">=</span><span class="s2">&quot;bus </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">node</span><span class="p">),</span> 
                 <span class="n">p_set</span><span class="o">=</span><span class="n">loads</span><span class="p">[</span><span class="n">i</span><span class="p">],</span>
                 <span class="n">overwrite</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">network</span><span class="o">.</span><span class="n">loads_t</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{&#39;p_set&#39;: Load      gas demand DE  gas demand DK1  gas demand DK2  gas demand NO  \
 snapshot                                                                 
 0                   0.0          1000.0          1000.0         1000.0   
 1                   0.0          2000.0          1000.0         1000.0   
 2                3000.0          1000.0          1000.0         1000.0   
 
 Load      gas demand SE  
 snapshot                 
 0                   0.0  
 1                1000.0  
 2                   0.0  ,
 &#39;q_set&#39;: Empty DataFrame
 Columns: []
 Index: [0, 1, 2],
 &#39;p&#39;: Empty DataFrame
 Columns: []
 Index: [0, 1, 2],
 &#39;q&#39;: Empty DataFrame
 Columns: []
 Index: [0, 1, 2]}
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">network</span><span class="o">.</span><span class="n">optimize</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>WARNING:pypsa.consistency:The following links have carriers which are not defined:
Index([&#39;pipeline DE-DK1&#39;, &#39;pipeline DK1-DK2&#39;, &#39;pipeline DK1-NO&#39;,
       &#39;pipeline DK1-SE&#39;, &#39;pipeline DK2-SE&#39;, &#39;pipeline DK1-DE&#39;,
       &#39;pipeline DK2-DK1&#39;, &#39;pipeline NO-DK1&#39;, &#39;pipeline SE-DK1&#39;,
       &#39;pipeline SE-DK2&#39;],
      dtype=&#39;object&#39;, name=&#39;Link&#39;)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>WARNING:pypsa.consistency:The following buses have carriers which are not defined:
Index([&#39;bus DE&#39;, &#39;bus DK1&#39;, &#39;bus DK2&#39;, &#39;bus NO&#39;, &#39;bus SE&#39;], dtype=&#39;object&#39;, name=&#39;Bus&#39;)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>INFO:linopy.model: Solve problem using Highs solver
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>INFO:linopy.io: Writing time: 0.02s
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>INFO:linopy.constants: Optimization successful: 
Status: ok
Termination condition: optimal
Solution: 33 primals, 81 duals
Objective: 2.83e+05
Solver model: available
Solver message: Optimal
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>INFO:pypsa.optimization.optimize:The shadow-prices of the constraints Generator-fix-p-lower, Generator-fix-p-upper, Link-fix-p-lower, Link-fix-p-upper were not assigned to the network.
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Running HiGHS 1.10.0 (git hash: fd86653): Copyright (c) 2025 HiGHS under MIT licence terms
LP   linopy-problem-ptfl8otp has 81 rows; 33 cols; 129 nonzeros
Coefficient ranges:
  Matrix [1e+00, 1e+00]
  Cost   [2e+01, 2e+01]
  Bound  [0e+00, 0e+00]
  RHS    [1e+03, 1e+05]
Presolving model
12 rows, 30 cols, 54 nonzeros  0s
Dependent equations search running on 12 equations with time limit of 1000.00s
Dependent equations search removed 0 rows and 0 nonzeros in 0.00s (limit = 1000.00s)
12 rows, 30 cols, 54 nonzeros  0s
Presolve : Reductions: rows 12(-69); columns 30(-3); elements 54(-75)
Solving the presolved LP
Using EKK dual simplex solver - serial
  Iteration        Objective     Infeasibilities num(sum)
          0     1.1758012135e-03 Pr: 10(14036.4) 0s
         18     2.8332350627e+05 Pr: 0(0) 0s
Solving the original LP from the solution after postsolve
Model name          : linopy-problem-ptfl8otp
Model status        : Optimal
Simplex   iterations: 18
Objective value     :  2.8332350627e+05
Relative P-D gap    :  2.0544592886e-16
HiGHS run time      :          0.00
Writing the solution to /tmp/linopy-solve-_i9yzavu.sol
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(&#39;ok&#39;, &#39;optimal&#39;)
</pre></div>
</div>
</div>
</div>
<p>We can see the gas flows in every pipeline using</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">network</span><span class="o">.</span><span class="n">links_t</span><span class="o">.</span><span class="n">p0</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>Link</th>
      <th>pipeline DE-DK1</th>
      <th>pipeline DK1-DK2</th>
      <th>pipeline DK1-NO</th>
      <th>pipeline DK1-SE</th>
      <th>pipeline DK2-SE</th>
      <th>pipeline DK1-DE</th>
      <th>pipeline DK2-DK1</th>
      <th>pipeline NO-DK1</th>
      <th>pipeline SE-DK1</th>
      <th>pipeline SE-DK2</th>
    </tr>
    <tr>
      <th>snapshot</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>-0.0</td>
      <td>1004.016064</td>
      <td>-0.0</td>
      <td>-0.0</td>
      <td>-0.000000</td>
      <td>-0.000000</td>
      <td>-0.0</td>
      <td>2024.258651</td>
      <td>-0.0</td>
      <td>-0.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>-0.0</td>
      <td>2010.044185</td>
      <td>-0.0</td>
      <td>-0.0</td>
      <td>1002.004008</td>
      <td>-0.000000</td>
      <td>-0.0</td>
      <td>4050.549682</td>
      <td>-0.0</td>
      <td>-0.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>-0.0</td>
      <td>1004.016064</td>
      <td>-0.0</td>
      <td>-0.0</td>
      <td>-0.000000</td>
      <td>3036.437247</td>
      <td>-0.0</td>
      <td>5091.366981</td>
      <td>-0.0</td>
      <td>-0.0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>And the total system cost is</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">network</span><span class="o">.</span><span class="n">objective</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>283323.50626732665
</pre></div>
</div>
</div>
</div>
<p><em><strong>(e) Modify the demand for the German node to be DE=[0,0,6] GWh and keep the other node as in the previous section. Calculate the optimal flows in every time step and the total system costs.</strong></em></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">network</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s2">&quot;Load&quot;</span><span class="p">,</span> 
            <span class="s2">&quot;gas demand DE&quot;</span><span class="p">,</span> 
            <span class="n">bus</span><span class="o">=</span><span class="s2">&quot;bus DE&quot;</span><span class="p">,</span> 
            <span class="n">p_set</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">6000</span><span class="p">],</span>
            <span class="n">overwrite</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">network</span><span class="o">.</span><span class="n">optimize</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>WARNING:pypsa.consistency:The following links have carriers which are not defined:
Index([&#39;pipeline DE-DK1&#39;, &#39;pipeline DK1-DK2&#39;, &#39;pipeline DK1-NO&#39;,
       &#39;pipeline DK1-SE&#39;, &#39;pipeline DK2-SE&#39;, &#39;pipeline DK1-DE&#39;,
       &#39;pipeline DK2-DK1&#39;, &#39;pipeline NO-DK1&#39;, &#39;pipeline SE-DK1&#39;,
       &#39;pipeline SE-DK2&#39;],
      dtype=&#39;object&#39;, name=&#39;Link&#39;)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>WARNING:pypsa.consistency:The following buses have carriers which are not defined:
Index([&#39;bus DE&#39;, &#39;bus DK1&#39;, &#39;bus DK2&#39;, &#39;bus NO&#39;, &#39;bus SE&#39;], dtype=&#39;object&#39;, name=&#39;Bus&#39;)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>INFO:linopy.model: Solve problem using Highs solver
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>INFO:linopy.io: Writing time: 0.02s
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>WARNING:linopy.constants:Optimization potentially failed: 
Status: warning
Termination condition: infeasible
Solution: 0 primals, 0 duals
Objective: nan
Solver model: available
Solver message: Infeasible
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Running HiGHS 1.10.0 (git hash: fd86653): Copyright (c) 2025 HiGHS under MIT licence terms
LP   linopy-problem-koakchwe has 81 rows; 33 cols; 129 nonzeros
Coefficient ranges:
  Matrix [1e+00, 1e+00]
  Cost   [2e+01, 2e+01]
  Bound  [0e+00, 0e+00]
  RHS    [1e+03, 1e+05]
Presolving model
Problem status detected on presolve: Infeasible
Model name          : linopy-problem-koakchwe
Model status        : Infeasible
Objective value     :  0.0000000000e+00
HiGHS run time      :          0.00
Writing the solution to /tmp/linopy-solve-zj910bd1.sol
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(&#39;warning&#39;, &#39;infeasible&#39;)
</pre></div>
</div>
</div>
</div>
<p>The model is unfeasible because the capacity of the link connecting DK1 and DE is not enought to transport 6 GWh in the last time step.</p>
<p><strong>(f) Assume that the pipeline pressure can be increased from 50 to 55 bar, calculate the linepack, i.e., the energy that can be stored in every pipeline by increasing the pressure. Represent this in your pypsa model by adding a store with that capacity at the beginning of every line, calculate the optimal gas flows in every time step and the total system costs.</strong></p>
<p>The energy that can be stored by changing the pressure of the pipeline can be calculated as <span class="math notranslate nohighlight">\(Linepack=\frac{\Delta P}{c^2} A·L·e\)</span> (for this example we assume length <span class="math notranslate nohighlight">\(L\)</span>=1000 km), where we use the energy content (in GJ/tonnes) and convert it to MWh/kg to calculate the linepack in MWh</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">L</span> <span class="o">=</span> <span class="mi">1000</span> <span class="c1"># km</span>
<span class="n">Delta_P</span> <span class="o">=</span> <span class="p">(</span><span class="mi">55</span><span class="o">-</span><span class="mi">50</span><span class="p">)</span><span class="o">*</span><span class="mi">100000</span> <span class="c1"># Pa</span>

<span class="n">Linepack</span> <span class="o">=</span> <span class="p">(</span><span class="n">Delta_P</span><span class="o">/</span><span class="n">c</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">A</span><span class="o">*</span><span class="n">L</span><span class="o">*</span><span class="mi">1000</span><span class="o">*</span><span class="n">e</span><span class="o">*</span><span class="mf">0.000277</span>
<span class="n">Linepack</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>np.float64(9652.383367497767)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">network</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s2">&quot;Store&quot;</span><span class="p">,</span> <span class="s2">&quot;linepack DE-DK1&quot;</span><span class="p">,</span> <span class="n">bus</span><span class="o">=</span><span class="s2">&quot;bus DE&quot;</span><span class="p">,</span> <span class="n">e_nom</span><span class="o">=</span><span class="n">Linepack</span><span class="o">*</span><span class="mi">600</span><span class="o">/</span><span class="mi">1000</span><span class="p">,</span> <span class="n">overwrite</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">network</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s2">&quot;Store&quot;</span><span class="p">,</span> <span class="s2">&quot;linepack DK1-DK2&quot;</span><span class="p">,</span> <span class="n">bus</span><span class="o">=</span><span class="s2">&quot;bus DK1&quot;</span><span class="p">,</span> <span class="n">e_nom</span><span class="o">=</span><span class="n">Linepack</span><span class="o">*</span><span class="mi">200</span><span class="o">/</span><span class="mi">1000</span><span class="p">,</span> <span class="n">overwrite</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">network</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s2">&quot;Store&quot;</span><span class="p">,</span> <span class="s2">&quot;linepack DK1-NO&quot;</span><span class="p">,</span> <span class="n">bus</span><span class="o">=</span><span class="s2">&quot;bus DK1&quot;</span><span class="p">,</span> <span class="n">e_nom</span><span class="o">=</span><span class="n">Linepack</span><span class="o">*</span><span class="mi">500</span><span class="o">/</span><span class="mi">1000</span><span class="p">,</span> <span class="n">overwrite</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">network</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s2">&quot;Store&quot;</span><span class="p">,</span> <span class="s2">&quot;linepack DK1-SE&quot;</span><span class="p">,</span> <span class="n">bus</span><span class="o">=</span><span class="s2">&quot;bus DK1&quot;</span><span class="p">,</span> <span class="n">e_nom</span><span class="o">=</span><span class="n">Linepack</span><span class="o">*</span><span class="mi">600</span><span class="o">/</span><span class="mi">1000</span><span class="p">,</span> <span class="n">overwrite</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">network</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s2">&quot;Store&quot;</span><span class="p">,</span> <span class="s2">&quot;linepack DK2-SE&quot;</span><span class="p">,</span> <span class="n">bus</span><span class="o">=</span><span class="s2">&quot;bus DK2&quot;</span><span class="p">,</span> <span class="n">e_nom</span><span class="o">=</span><span class="n">Linepack</span><span class="o">*</span><span class="mi">100</span><span class="o">/</span><span class="mi">1000</span><span class="p">,</span> <span class="n">overwrite</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">network</span><span class="o">.</span><span class="n">stores</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>bus</th>
      <th>type</th>
      <th>carrier</th>
      <th>e_nom</th>
      <th>e_nom_mod</th>
      <th>e_nom_extendable</th>
      <th>e_nom_min</th>
      <th>e_nom_max</th>
      <th>e_min_pu</th>
      <th>e_max_pu</th>
      <th>...</th>
      <th>sign</th>
      <th>marginal_cost</th>
      <th>marginal_cost_quadratic</th>
      <th>marginal_cost_storage</th>
      <th>capital_cost</th>
      <th>standing_loss</th>
      <th>active</th>
      <th>build_year</th>
      <th>lifetime</th>
      <th>e_nom_opt</th>
    </tr>
    <tr>
      <th>Store</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>linepack DE-DK1</th>
      <td>bus DE</td>
      <td></td>
      <td></td>
      <td>5791.430020</td>
      <td>0.0</td>
      <td>False</td>
      <td>0.0</td>
      <td>inf</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>...</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>True</td>
      <td>0</td>
      <td>inf</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>linepack DK1-DK2</th>
      <td>bus DK1</td>
      <td></td>
      <td></td>
      <td>1930.476673</td>
      <td>0.0</td>
      <td>False</td>
      <td>0.0</td>
      <td>inf</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>...</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>True</td>
      <td>0</td>
      <td>inf</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>linepack DK1-NO</th>
      <td>bus DK1</td>
      <td></td>
      <td></td>
      <td>4826.191684</td>
      <td>0.0</td>
      <td>False</td>
      <td>0.0</td>
      <td>inf</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>...</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>True</td>
      <td>0</td>
      <td>inf</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>linepack DK1-SE</th>
      <td>bus DK1</td>
      <td></td>
      <td></td>
      <td>5791.430020</td>
      <td>0.0</td>
      <td>False</td>
      <td>0.0</td>
      <td>inf</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>...</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>True</td>
      <td>0</td>
      <td>inf</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>linepack DK2-SE</th>
      <td>bus DK2</td>
      <td></td>
      <td></td>
      <td>965.238337</td>
      <td>0.0</td>
      <td>False</td>
      <td>0.0</td>
      <td>inf</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>...</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>True</td>
      <td>0</td>
      <td>inf</td>
      <td>0.0</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 26 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">network</span><span class="o">.</span><span class="n">optimize</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>WARNING:pypsa.consistency:The following links have carriers which are not defined:
Index([&#39;pipeline DE-DK1&#39;, &#39;pipeline DK1-DK2&#39;, &#39;pipeline DK1-NO&#39;,
       &#39;pipeline DK1-SE&#39;, &#39;pipeline DK2-SE&#39;, &#39;pipeline DK1-DE&#39;,
       &#39;pipeline DK2-DK1&#39;, &#39;pipeline NO-DK1&#39;, &#39;pipeline SE-DK1&#39;,
       &#39;pipeline SE-DK2&#39;],
      dtype=&#39;object&#39;, name=&#39;Link&#39;)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>WARNING:pypsa.consistency:The following buses have carriers which are not defined:
Index([&#39;bus DE&#39;, &#39;bus DK1&#39;, &#39;bus DK2&#39;, &#39;bus NO&#39;, &#39;bus SE&#39;], dtype=&#39;object&#39;, name=&#39;Bus&#39;)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>WARNING:pypsa.consistency:The following stores have carriers which are not defined:
Index([&#39;linepack DE-DK1&#39;, &#39;linepack DK1-DK2&#39;, &#39;linepack DK1-NO&#39;,
       &#39;linepack DK1-SE&#39;, &#39;linepack DK2-SE&#39;],
      dtype=&#39;object&#39;, name=&#39;Store&#39;)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>INFO:linopy.model: Solve problem using Highs solver
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>INFO:linopy.io: Writing time: 0.03s
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>INFO:linopy.constants: Optimization successful: 
Status: ok
Termination condition: optimal
Solution: 63 primals, 126 duals
Objective: 3.45e+05
Solver model: available
Solver message: Optimal
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>INFO:pypsa.optimization.optimize:The shadow-prices of the constraints Generator-fix-p-lower, Generator-fix-p-upper, Link-fix-p-lower, Link-fix-p-upper, Store-fix-e-lower, Store-fix-e-upper, Store-energy_balance were not assigned to the network.
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Running HiGHS 1.10.0 (git hash: fd86653): Copyright (c) 2025 HiGHS under MIT licence terms
LP   linopy-problem-f46zp6se has 126 rows; 63 cols; 214 nonzeros
Coefficient ranges:
  Matrix [1e+00, 1e+00]
  Cost   [2e+01, 2e+01]
  Bound  [0e+00, 0e+00]
  RHS    [1e+03, 1e+05]
Presolving model
25 rows, 58 cols, 108 nonzeros  0s
15 rows, 48 cols, 88 nonzeros  0s
Dependent equations search running on 15 equations with time limit of 1000.00s
Dependent equations search removed 0 rows and 0 nonzeros in 0.00s (limit = 1000.00s)
15 rows, 42 cols, 78 nonzeros  0s
Presolve : Reductions: rows 15(-111); columns 42(-21); elements 78(-136)
Solving the presolved LP
Using EKK dual simplex solver - serial
  Iteration        Objective     Infeasibilities num(sum)
          0     0.0000000000e+00 Pr: 11(17000) 0s
         24     3.4466567287e+05 Pr: 0(0) 0s
Solving the original LP from the solution after postsolve
Model name          : linopy-problem-f46zp6se
Model status        : Optimal
Simplex   iterations: 24
Objective value     :  3.4466567287e+05
Relative P-D gap    :  0.0000000000e+00
HiGHS run time      :          0.00
Writing the solution to /tmp/linopy-solve-h4radop3.sol
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(&#39;ok&#39;, &#39;optimal&#39;)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">network</span><span class="o">.</span><span class="n">objective</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>344665.67287265125
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">network</span><span class="o">.</span><span class="n">links_t</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{&#39;efficiency&#39;: Empty DataFrame
 Columns: []
 Index: [0, 1, 2],
 &#39;p_set&#39;: Empty DataFrame
 Columns: []
 Index: [0, 1, 2],
 &#39;p_min_pu&#39;: Empty DataFrame
 Columns: []
 Index: [0, 1, 2],
 &#39;p_max_pu&#39;: Empty DataFrame
 Columns: []
 Index: [0, 1, 2],
 &#39;marginal_cost&#39;: Empty DataFrame
 Columns: []
 Index: [0, 1, 2],
 &#39;marginal_cost_quadratic&#39;: Empty DataFrame
 Columns: []
 Index: [0, 1, 2],
 &#39;stand_by_cost&#39;: Empty DataFrame
 Columns: []
 Index: [0, 1, 2],
 &#39;ramp_limit_up&#39;: Empty DataFrame
 Columns: []
 Index: [0, 1, 2],
 &#39;ramp_limit_down&#39;: Empty DataFrame
 Columns: []
 Index: [0, 1, 2],
 &#39;p0&#39;: Link      pipeline DE-DK1  pipeline DK1-DK2  pipeline DK1-NO  pipeline DK1-SE  \
 snapshot                                                                        
 0                    -0.0       1004.016064             -0.0             -0.0   
 1                    -0.0       2010.044185             -0.0             -0.0   
 2                    -0.0       1004.016064             -0.0             -0.0   
 
 Link      pipeline DK2-SE  pipeline DK1-DE  pipeline DK2-DK1  pipeline NO-DK1  \
 snapshot                                                                        
 0               -0.000000      3170.637113              -0.0      5226.922401   
 1             1002.004008      1164.608992              -0.0      5226.922401   
 2               -0.000000      1737.628389              -0.0      3779.438841   
 
 Link      pipeline SE-DK1  pipeline SE-DK2  
 snapshot                                    
 0                    -0.0             -0.0  
 1                    -0.0             -0.0  
 2                    -0.0             -0.0  ,
 &#39;p1&#39;: Link      pipeline DE-DK1  pipeline DK1-DK2  pipeline DK1-NO  pipeline DK1-SE  \
 snapshot                                                                        
 0                     0.0      -1000.000000              0.0              0.0   
 1                     0.0      -2002.004008              0.0              0.0   
 2                     0.0      -1000.000000              0.0              0.0   
 
 Link      pipeline DK2-SE  pipeline DK1-DE  pipeline DK2-DK1  pipeline NO-DK1  \
 snapshot                                                                        
 0                     0.0     -3132.589468               0.0     -5174.653177   
 1                 -1000.0     -1150.633684               0.0     -5174.653177   
 2                     0.0     -1716.776848               0.0     -3741.644453   
 
 Link      pipeline SE-DK1  pipeline SE-DK2  
 snapshot                                    
 0                     0.0              0.0  
 1                     0.0              0.0  
 2                     0.0              0.0  ,
 &#39;status&#39;: Empty DataFrame
 Columns: []
 Index: [0, 1, 2],
 &#39;mu_lower&#39;: Empty DataFrame
 Columns: []
 Index: [0, 1, 2],
 &#39;mu_upper&#39;: Empty DataFrame
 Columns: []
 Index: [0, 1, 2],
 &#39;mu_p_set&#39;: Empty DataFrame
 Columns: []
 Index: [0, 1, 2],
 &#39;mu_ramp_limit_up&#39;: Empty DataFrame
 Columns: []
 Index: [0, 1, 2],
 &#39;mu_ramp_limit_down&#39;: Empty DataFrame
 Columns: []
 Index: [0, 1, 2]}
</pre></div>
</div>
</div>
</div>
<p>The model is now feasible because part of the energy to be transmited in the link DE-DK1 can be stored as linepack</p>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./Problems"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="Problem05.04.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Problem 5.4</p>
      </div>
    </a>
    <a class="right-next"
       href="Problem06.02.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Problem 6.2</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Marta Victoria, Aleksander Grochowicz
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2025.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>